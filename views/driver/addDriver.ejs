<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Driver - Quick Explore</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

    <style>
        :root {
            --primary-color: #4a90e2;
            --secondary-color: #2c3e50;
            --light-gray: #f8f9fa;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --form-bg: #ffffff;
        }
        
        body {
            background-color: var(--light-gray);
            font-family: 'Poppins', sans-serif;
            padding-top: 70px;
        }
        
        .navbar {
            background: var(--secondary-color);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .navbar-brand {
            font-weight: 700;
            color: white !important;
        }
        
        .navbar-brand i {
            color: var(--primary-color);
        }
        
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            color: white !important;
        }
        
        .container {
            margin-top: 2rem;
            margin-bottom: 2rem;
        }
        
        .page-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .form-card {
            background: var(--form-bg);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 2rem;
            border: none;
        }
        
        .form-header {
            background: var(--primary-color);
            color: white;
            padding: 1.5rem;
            text-align: center;
        }
        
        .form-header h3 {
            margin: 0;
            font-weight: 600;
        }
        
        .form-body {
            padding: 2rem;
        }
        
        .form-control {
            border-radius: 8px;
            padding: 0.8rem 1rem;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(74, 144, 226, 0.25);
        }
        
        .form-label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--secondary-color);
            display: flex;
            align-items: center;
        }
        
        .form-label i {
            margin-right: 10px;
            color: var(--primary-color);
        }
        
        .btn-submit {
            background: linear-gradient(to right, var(--primary-color), #357abd);
            border: none;
            border-radius: 50px;
            padding: 0.8rem 2rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: white;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }
        
        .btn-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(53, 122, 189, 0.4);
        }
        
        .form-icon {
            font-size: 8rem;
            color: var(--primary-color);
            opacity: 0.1;
            position: absolute;
            bottom: -15px;
            right: -15px;
            transform: rotate(-15deg);
        }
        
        .form-floating {
            position: relative;
            margin-bottom: 1.5rem;
        }
        
        .form-feature {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .form-feature i {
            color: var(--success-color);
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .form-features {
            background: var(--light-gray);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }
        
        .form-features h4 {
            margin-bottom: 1rem;
            color: var(--secondary-color);
            font-weight: 600;
        }
        
        .navigation-links {
            text-align: center;
            margin-top: 1.5rem;
        }
        
        .navigation-links a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .navigation-links a:hover {
            color: #357abd;
            text-decoration: underline;
        }
        
        .form-footer {
            text-align: center;
            margin-top: 1rem;
            color: #6c757d;
        }
        
        .invalid-feedback {
            display: none;
            color: var(--danger-color);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        
        .form-control.is-valid {
            border-color: var(--success-color);
            padding-right: calc(1.5em + 0.75rem);
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%2328a745' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right calc(0.375em + 0.1875rem) center;
            background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
        }
        
        .form-control.is-invalid {
            border-color: var(--danger-color);
            padding-right: calc(1.5em + 0.75rem);
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='none' stroke='%23dc3545' viewBox='0 0 12 12'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right calc(0.375em + 0.1875rem) center;
            background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
        }
        
        .form-control.is-invalid ~ .invalid-feedback {
            display: block;
        }
        
        /* Progress bar styling */
        .form-progress-container {
            margin-bottom: 2rem;
            background: #f1f1f1;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 1px 5px rgba(0,0,0,0.1);
        }
        
        .form-progress-bar {
            height: 10px;
            background: linear-gradient(90deg, var(--primary-color) 0%, var(--success-color) 100%);
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }
        
        .progress-status {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.85rem;
            color: #6c757d;
        }
        
        .progress-label {
            font-weight: 600;
        }
        
        /* Field status indicator */
        .field-status-container {
            display: flex;
            justify-content: center;
            margin: 1rem 0;
        }
        
        .field-status {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin: 0 5px;
            background-color: #e9ecef;
            transition: all 0.3s ease;
        }
        
        .field-status.valid {
            background-color: var(--success-color);
        }
        
        .field-status.invalid {
            background-color: var(--danger-color);
        }
        
        .dropdown-search {
            position: relative;
        }
        
        .dropdown-search input {
            padding-right: 30px;
            margin-bottom: 8px;
        }
        
        .dropdown-search i {
            position: absolute;
            right: 10px;
            top: 10px;
            color: var(--primary-color);
        }
        
        .select-wrapper {
            position: relative;
        }
        
        .select-wrapper::after {
            content: "\f078";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            color: var(--primary-color);
        }
        
        /* Style for the custom select2 dropdown */
        .select2-container {
            width: 100% !important;
            display: block;
        }
        
        .select2-container .select2-selection--single {
            height: calc(3.5rem + 2px) !important;
            border: 2px solid #e9ecef !important;
            border-radius: 8px !important;
            font-size: 1rem;
            line-height: 1.5;
            transition: all 0.3s ease;
        }
        
        .select2-container--default .select2-selection--single .select2-selection__rendered {
            color: #495057;
            line-height: calc(3.5rem);
            padding-left: 1rem;
        }
        
        .select2-container--default .select2-selection--single .select2-selection__placeholder {
            color: #6c757d;
        }
        
        .select2-container--default .select2-selection--single .select2-selection__arrow {
            height: calc(3.5rem + 2px);
            width: 50px;
            right: 0;
        }
        
        .select2-container--default .select2-selection--single .select2-selection__arrow b {
            border-width: 8px 6px 0 6px;
        }
        
        .select2-dropdown {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            z-index: 9999;
        }
        
        .select2-container--open .select2-dropdown--below {
            border-top: none;
            border-top-left-radius: 0;
            border-top-right-radius: 0;
        }
        
        .select2-search--dropdown {
            padding: 10px;
        }
        
        .select2-search--dropdown .select2-search__field {
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 12px;
            font-size: 1rem;
        }
        
        .select2-results__option {
            padding: 10px 15px;
            font-size: 0.95rem;
        }
        
        .select2-container--default .select2-results__option--highlighted[aria-selected] {
            background-color: var(--primary-color);
        }
    </style>
    <!-- Select2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="/admin">
                <i class="fas fa-map-marked-alt me-2"></i> Quick Explore
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/admin"><i class="fas fa-home me-1"></i> Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin"><i class="fas fa-tachometer-alt me-1"></i> Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="#"><i class="fas fa-user-plus me-1"></i> Add Driver</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/driver/assign-vehicle"><i class="fas fa-link me-1"></i> Assign Driver</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="page-header animate__animated animate__fadeIn">
            <h1 class="display-5 mb-2"><i class="fas fa-id-card me-3"></i>Driver Registration</h1>
            <p class="lead">Add new drivers to your Quick Explore platform</p>
        </div>

        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="form-card animate__animated animate__fadeInUp">
                    <div class="form-header">
                        <h3><i class="fas fa-user-plus me-2"></i>Driver Information</h3>
                    </div>
                    
                    <!-- Progress bar -->
                    <div class="form-progress-container mt-3 mx-3">
                        <div class="form-progress-bar" id="formProgress"></div>
                        <div class="progress-status">
                            <span class="progress-label">Completion:</span>
                            <span id="progressPercentage">0%</span>
                        </div>
                    </div>
                    
                    <!-- Field status indicators -->
                    <div class="field-status-container">
                        <div class="field-status" id="usernameStatus" title="Username"></div>
                        <div class="field-status" id="phoneStatus" title="Phone"></div>
                        <div class="field-status" id="emailStatus" title="Email"></div>
                        <div class="field-status" id="placeStatus" title="Location"></div>
                    </div>
                    
                    <div class="form-body position-relative">
                        <i class="fas fa-car form-icon"></i>
                        
                        <form action="/driver/add" method="POST" id="driverForm" novalidate>
                            <div class="mb-4">
                                <label for="username" class="form-label">
                                    <i class="fas fa-user"></i> Driver Name
                                </label>
                                <input type="text" name="username" id="username" class="form-control" 
                                       placeholder="Enter driver's full name" required 
                                       pattern="^[a-zA-Z\- ]{5,15}$" />
                                <div class="invalid-feedback">
                                    Username must be 5-15 characters and can only contain letters, spaces, and hyphens.
                                </div>
                            </div>

                            <div class="mb-4">
                                <label for="phone" class="form-label">
                                    <i class="fas fa-phone"></i> Phone Number
                                </label>
                                <input type="tel" name="phone" id="phone" class="form-control" 
                                       placeholder="10-digit phone number" required 
                                       pattern="^[6-9][0-9]{9}$" />
                                <div class="invalid-feedback">
                                    Please enter a valid 10-digit mobile number (starting with 6, 7, 8, or 9).
                                </div>
                            </div>

                            <div class="mb-4">
                                <label for="email" class="form-label">
                                    <i class="fas fa-envelope"></i> Email Address
                                </label>
                                <input type="email" name="email" id="email" class="form-control" 
                                       placeholder="driver@gmail.com" required 
                                       pattern="^[a-zA-Z0-9._%+-]+@gmail\.com$" />
                                <div class="invalid-feedback">
                                    Please enter a valid Gmail address (example@gmail.com).
                                </div>
                            </div>

                            <div class="mb-4">
                                <label for="place" class="form-label">
                                    <i class="fas fa-map-marker-alt"></i> Location/City
                                </label>
                                <div class="select-wrapper">
                                    <select name="place" id="place" class="form-control select2" required>
                                        <option value=""></option>
                                        <% 
                                        const places = [
                                          "Charminar", "Golconda Fort", "Ramoji Film City", "Bhadrakali Temple", "Kuntala Waterfalls",
                                          "Nagarjuna Sagar Dam", "Pakhal Lake", "Medak Cathedral", "Bogatha Waterfall", "Laknavaram Lake",
                                          "Yadagirigutta Temple", "Ananthagiri Hills", "Kadam Dam", "Alampur Jogulamba Temple", "Khammam Fort",
                                          "Pocharam Wildlife Sanctuary", "Ethipothala Falls", "Warangal Fort", "Sammakka Saralamma Temple",
                                          "Thousand Pillar Temple", "Bhadrachalam Temple", "Sri Raja Rajeshwara Temple", "Kakatiya Musical Garden",
                                          "Sri Ramalingeswara Temple", "Edulabad Waterfalls", "Ananthagiri Temple",
                                          "Sri Lakshmi Narasimha Swamy Temple", "Kinnerasani Wildlife Sanctuary", "Dhulikatta Buddhist Stupa",
                                          "Jagtial Fort", "Bhongir Fort", "Nizam Sagar Dam", "Sri Kaleshwara Mukteswara Swamy Temple",
                                          "Jadcherla Sri Lakshmi Venkateswara Swamy Temple", "Pillalamarri Banyan Tree", "Koilkonda Fort",
                                          "Manthani Temples", "Mayuri Haritha Vanam", "Chaya Someswara Temple", "Jurala Dam", "Rachakonda Fort",
                                          "Surendrapuri Mythological Museum", "Narsapur Forest", "Antharaganga Waterfalls", "Kinnerasani Dam",
                                          "Medaram Jatara Festival Grounds", "Shamirpet Lake", "Dichpally Ramalayam", "Pochera Waterfalls",
                                          "Eegalapenta Reservoir", "Phanigiri Buddhist Site"
                                        ];
                                        places.sort();
                                        places.forEach(place => { %>
                                        <option value="<%= place %>"><%= place %></option>
                                        <% }); %>
                                    </select>
                                </div>
                                <div class="invalid-feedback">
                                    Please select a location.
                                </div>
                            </div>

                            <button type="submit" class="btn btn-submit w-100">
                                <i class="fas fa-user-plus me-2"></i>Register Driver
                            </button>
                        </form>
                        
                        <div class="navigation-links mt-4">
                            <a href="/driver/assign-vehicle"><i class="fas fa-link me-1"></i> Assign Driver to Vehicle</a> | 
                            <a href="/admin"><i class="fas fa-arrow-left me-1"></i> Back to Dashboard</a>
                        </div>
                    </div>
                </div>

                <div class="form-features animate__animated animate__fadeInUp" style="animation-delay: 0.2s">
                    <h4><i class="fas fa-info-circle me-2"></i>Driver Registration Benefits</h4>
                    

                    <div class="form-feature">
                        <i class="fas fa-check-circle"></i>
                        <span>Easily assign drivers to vehicles for bookings</span>
                    </div>
                    <div class="form-feature">
                        <i class="fas fa-check-circle"></i>
                        <span>Streamlined management of your transportation fleet</span>
                    </div>
                    <div class="form-feature">
                        <i class="fas fa-check-circle"></i>
                        <span>Improve customer experience with professional drivers</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Select2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    
    <script>
        $(document).ready(function() {
            // Initialize Select2 for searchable dropdown
            $('.select2').select2({
                placeholder: "Search and select a location",
                allowClear: true,
                width: '100%'
            }).on('select2:open', function() {
                // Set focus to search field when dropdown opens
                setTimeout(function() {
                    $('.select2-search__field').attr('placeholder', 'Type to search...');
                    $('.select2-search__field').focus();
                }, 10);
            });
            
            // Improve keyboard navigation with Tab key
            $(document).on('keydown', '.select2-search__field', function(e) {
                if (e.key === "Tab") {
                    $('.select2').select2('close');
                }
            });
            
            // Form validation
            const form = document.getElementById('driverForm');
            const username = document.getElementById('username');
            const phone = document.getElementById('phone');
            const email = document.getElementById('email');
            const place = document.getElementById('place');
            
            // Progress elements
            const progressBar = document.getElementById('formProgress');
            const progressPercentage = document.getElementById('progressPercentage');
            const fieldStatuses = {
                username: document.getElementById('usernameStatus'),
                phone: document.getElementById('phoneStatus'),
                email: document.getElementById('emailStatus'),
                place: document.getElementById('placeStatus')
            };
            
            // Update progress bar
            function updateProgress() {
                const fields = [username, phone, email, place];
                let validCount = 0;
                
                fields.forEach(field => {
                    if (field.classList.contains('is-valid')) {
                        validCount++;
                        fieldStatuses[field.id].classList.add('valid');
                        fieldStatuses[field.id].classList.remove('invalid');
                    } else if (field.classList.contains('is-invalid')) {
                        fieldStatuses[field.id].classList.add('invalid');
                        fieldStatuses[field.id].classList.remove('valid');
                    } else {
                        fieldStatuses[field.id].classList.remove('valid');
                        fieldStatuses[field.id].classList.remove('invalid');
                    }
                });
                
                const progressValue = Math.round((validCount / fields.length) * 100);
                progressBar.style.width = `${progressValue}%`;
                progressPercentage.textContent = `${progressValue}%`;
                
                // Add animation effect when 100% complete
                if (progressValue === 100) {
                    progressBar.style.transition = "width 0.5s ease, background 1s ease";
                    progressBar.style.background = "linear-gradient(90deg, #28a745 0%, #20c997 100%)";
                } else {
                    progressBar.style.transition = "width 0.5s ease";
                    progressBar.style.background = "linear-gradient(90deg, var(--primary-color) 0%, var(--success-color) 100%)";
                }
            }
            
            form.addEventListener('submit', function(event) {
                let isValid = true;
                
                // Username validation
                if (!username.checkValidity()) {
                    username.classList.add('is-invalid');
                    username.classList.remove('is-valid');
                    isValid = false;
                } else {
                    username.classList.remove('is-invalid');
                    username.classList.add('is-valid');
                }
                
                // Phone validation
                if (!phone.checkValidity()) {
                    phone.classList.add('is-invalid');
                    phone.classList.remove('is-valid');
                    isValid = false;
                } else {
                    phone.classList.remove('is-invalid');
                    phone.classList.add('is-valid');
                }
                
                // Email validation
                if (!email.checkValidity()) {
                    email.classList.add('is-invalid');
                    email.classList.remove('is-valid');
                    isValid = false;
                } else {
                    email.classList.remove('is-invalid');
                    email.classList.add('is-valid');
                }
                
                // Place validation
                if (place.value === "" || place.value === null) {
                    place.classList.add('is-invalid');
                    place.classList.remove('is-valid');
                    isValid = false;
                } else {
                    place.classList.remove('is-invalid');
                    place.classList.add('is-valid');
                }
                
                updateProgress();
                
                if (!isValid) {
                    event.preventDefault();
                    event.stopPropagation();
                }
            });
            
            // Live validation
            const inputs = [username, phone, email];
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    validateField(this);
                    updateProgress();
                });
                
                input.addEventListener('blur', function() {
                    validateField(this);
                    updateProgress();
                });
            });
            
            // Special handling for select2
            $('#place').on('change', function() {
                validateField(place);
                updateProgress();
            });
            
            function validateField(field) {
                // Skip validation for empty fields until form submission, except for select
                if (field.value === "" && field.id !== "place") {
                    field.classList.remove('is-valid');
                    field.classList.remove('is-invalid');
                    return;
                }
                
                if (field.checkValidity() && (field.id !== "place" || field.value !== "")) {
                    field.classList.remove('is-invalid');
                    field.classList.add('is-valid');
                } else {
                    field.classList.add('is-invalid');
                    field.classList.remove('is-valid');
                }
            }
            
            // Initialize tooltips for field status indicators
            $('[title]').tooltip();
        });
    </script>
</body>
</html>